<div class="container">
  
  <div class="header">
    <h1>Trading Servers</h1>
    

  <hr />

  
  </div>


  <div *ngIf="loading" class="loading">
    Loading servers...
  </div>

  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  

<div class="servers-header">
  <button class="add-btn" (click)="toggleAddForm()">
    {{ showAddForm ? 'âœ– Close' : '+ Add Server' }}
  </button>
</div>

<div *ngIf="showAddForm" class="add-server-card animate-in">
  <h3>Add New Server</h3>
  <div class="form-grid">
    <input type="text" placeholder="Server Name" [(ngModel)]="newServer.server">
    <input type="text" placeholder="Platform" [(ngModel)]="newServer.platform">
    <input type="text" placeholder="User" [(ngModel)]="newServer.user">
    <input type="password" placeholder="Password" [(ngModel)]="newServer.pwd">
    <input type="text" placeholder="IP Address" [(ngModel)]="newServer.ip">
    <input type="number" placeholder="Port" [(ngModel)]="newServer.port">
    <label class="chk">
      <input type="checkbox" [(ngModel)]="newServer.is_active">
      Active
    </label>
  </div>

  <div class="form-actions">
    <button class="save-btn" (click)="addServer()">ðŸ’¾ Save</button>
    <button class="cancel-btn" (click)="toggleAddForm()">Cancel</button>
  </div>
</div>

<!-- </div> -->
 <div *ngIf="!loading && servers.length > 0" class="servers-grid-container">

  <!-- Intestazioni -->
  <div class="grid-header">
    <div class="grid-cell">Server</div>
    <div class="grid-cell">Platform</div>
    <div class="grid-cell">User</div>
    <div class="grid-cell">Password</div>
    <div class="grid-cell">IP</div>
    <div class="grid-cell">Port</div>
    <!-- <div class="grid-cell">Status</div>
    <div class="grid-cell">Actions</div>  -->

  </div>

  
  <!-- Dati dei server -->
  <div class="grid-body">
    <div *ngFor="let server of servers; let i = index" class="grid-row">
      <div class="grid-cell">{{ server.server }}</div>
      <div class="grid-cell">{{ server.platform }}</div>
      <div class="grid-cell">{{ server.user }}</div>
      <div class="grid-cell">{{ server.pwd }}</div>
      <div class="grid-cell">{{ server.ip }}</div>
      <div class="grid-cell">{{ server.port }}</div>
      <div class="grid-cell">
        <span class="status-badge"
              [class.active]="server.is_active"
              [class.inactive]="!server.is_active">
          {{ server.is_active ? 'Active' : 'Inactive' }}
        </span>
      </div>
      <div class="grid-cell">
        <button class="action-btn secondary" (click)="deleteServer(server)">Delete</button>
      </div>
      <div class="grid-cell">
        <button class="action-btn primary" (click)="checkServer(i)" [disabled]="testingIndex === i">Test</button>
        <!-- Loader solo per il server cliccato -->
        <div *ngIf="testingIndex === i" class="loader-with-spinner">
          <div class="spinner"></div>
          <span class="animated-text">Connecting<span class="dots"></span></span>

        </div>


      </div>
    </div>
  </div>

  




</div>




  <!-- <div *ngIf="!loading && servers.length > 0" class="servers-grid">
    <div *ngFor="let server of servers" class="server-card">
      <div class="server-header">
        <h2>{{ server.server }}</h2>
        <span
          class="status-badge"
          [class.active]="server.is_active"
          [class.inactive]="!server.is_active">
          {{ server.is_active ? 'Active' : 'Inactive' }}
        </span>
      </div>

      <div class="server-details">
        <div class="detail-row">
          <span class="label">Platform:</span>
          <span class="value">{{ server.platform }}</span>
        </div>
        <div class="detail-row">
          <span class="label">User:</span>
          <span class="value">{{ server.user }}</span>
        </div>
        <div class="detail-row">
          <span class="label">IP:</span>
          <span class="value">{{ server.ip }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Port:</span>
          <span class="value">{{ server.port }}</span>
        </div>
      </div>
    </div>
  </div> -->

  <div *ngIf="!loading && servers.length === 0 && !error" class="empty-state">
    No servers found
  </div>

  
</div>

<!-- Loader -->
  <div *ngIf="isLoading" class="loader">
    Testing...
  </div>
